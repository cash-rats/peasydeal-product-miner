services:
  runner:
    build:
      context: .
      dockerfile: Dockerfile
    environment:
      - HOME=/codex
      - GEMINI_HOME=/gemini
      - CODEX_CMD=codex
      - CODEX_SKIP_GIT_REPO_CHECK=${CODEX_SKIP_GIT_REPO_CHECK:-1}
      - TARGET_URL=${TARGET_URL}
    stdin_open: true
    tty: true
    volumes:
      - ./out:/out
      - ./config:/app/config:ro
      - ./codex:/codex:rw
      - ./gemini:/gemini:rw
    # Template: run a single URL (set TARGET_URL in `.env`).
    command: >
      sh -lc
      '/app/runner
      --url "${TARGET_URL}"
      --out-dir /out'
